<!doctype html><html lang=en><head><title>AI-Assisted Trader (Part 2)</title><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.780dc7a6fc8e42bf9fef490724bc6cbc57e759a0db2df60fcd517f9f667085ed.css integrity="sha256-eA3HpvyOQr+f70kHJLxsvFfnWaDbLfYPzVF/n2Zwhe0="><link rel=icon type=image/png href=/images/site/favicon.svg><meta property="og:title" content="Steven's Portfolio"><meta property="og:type" content="website"><meta property="og:description" content="Portfolio and personal blog of Steven Lasch."><meta property="og:image" content="/images/author/me.jpg"><meta property="og:url" content="https://slasch-website.netlify.app"><meta name=description content="Is it possible to use reinforcement learning to perform stock trading? Find out how in this mini-series."><script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">let theme=localStorage.getItem("theme-scheme")||localStorage.getItem("darkmode:color-scheme")||"light";theme==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/main-logo.svg id=logo alt=Logo>
Steven Lasch Portfolio</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>‡¶π‡ßã‡¶Æ</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#skills>Skills</a></li><li class=nav-item><a class=nav-link href=/#experiences>Work Experience</a></li><li class=nav-item><a class=nav-link href=/#education>Education</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>‡¶Ü‡¶∞‡ßã</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#projects>Projects</a>
<a class=dropdown-item href=/#publications>Publications</a>
<a class=dropdown-item href=/#featured-posts>Featured Posts</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>‡¶™‡ßã‡¶∑‡ßç‡¶ü ‡¶∏‡¶Æ‡ßÇ‡¶π</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo.svg class=d-none id=main-logo alt=Logo>
<img src=/images/site/main-logo.svg class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder="‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®" data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>‡¶™‡ßã‡¶∑‡ßç‡¶ü ‡¶∏‡¶Æ‡ßÇ‡¶π</a></li><div class=subtree><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/ai-trader/> AI Stock Trader Mini-Series</a><ul class=active><li><a class=list-link href=/posts/ai-trader/part-1/ title="AI Trader Pt. 1">AI Trader Pt. 1</a></li><li><a class="active list-link" href=/posts/ai-trader/part-2/ title="AI Trader Pt. 2">AI Trader Pt. 2</a></li><li><a class=list-link href=/posts/ai-trader/part-3/ title="AI Trader Pt. 3">AI Trader Pt. 3</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/author/me_hu_cdbce0c24b9941d9.jpg alt="Author Image"><h5 class=author-name>Steven Lasch</h5><p class=text-muted>Friday, November 29, 2024 | 4 ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</p></div><div class=title><h1>AI-Assisted Trader (Part 2)</h1></div><div class=tags><ul style=padding-left:0></ul></div><div class=post-content id=post-content><h2 id=tldr>TLDR</h2><p>This is Part 2 of my series on an AI-assisted stock trader. Refer to <a href=https://steven-lasch.com/posts/ai-trader/part-1/ target=_blank rel=noopener>Part 1</a> to get more information on the requirements for a Q-Learner, though I will give a brief
introduction anyway. A Q-Learner is a type of reinforcement learning algorithm to find the optimal strategy based on its environment. It requires an <strong>action</strong>, a <strong>state</strong>, and some <strong>reward</strong> for taking an action (reward can be positive to encourage an action, or negative to discourage an action).</p><p>This post will apply Part 1&rsquo;s general tips to the context of trading.</p><h2 id=the-process>The Process</h2><p>For our learner, technical analysis indicators will be used to predict future prices. We will loop multiple times through each day in our training data. A matrix of these indicators will be sent to our discretization function, returning an integer representing the state of the market for each day in our training data.</p><p>Here is some pseudocode that generalizes this approach:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>while learner not converged on an optimal policy:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	for each day:
</span></span><span style=display:flex><span>		get indicators for today
</span></span><span style=display:flex><span>		state = discretize the indicators
</span></span><span style=display:flex><span>		reward = calculate the reward for trading today
</span></span><span style=display:flex><span>		action = query(state, reward) the learner
</span></span><span style=display:flex><span>		
</span></span><span style=display:flex><span>		if the leaner signals a buy action:
</span></span><span style=display:flex><span>			if we&#39;re currently short, go long
</span></span><span style=display:flex><span>			if we&#39;re not in the market, enter market at 1,000 shares long
</span></span><span style=display:flex><span>		else if the learner signals a sell action:
</span></span><span style=display:flex><span>			if we&#39;re currently long, go short
</span></span><span style=display:flex><span>			if we&#39;re not in the market, enter market at -1,000 shares short
</span></span><span style=display:flex><span>		else
</span></span><span style=display:flex><span>			exit the market (return holdings to 0 shares)
</span></span></code></pre></div><p>The outer while-loop controls <strong>convergence</strong>. A learner will converge on an optimal policy once the actions taken by the learner for similar states stabilizes. This suggests that the learner has found consistent rewards for its actions. Once the learner converges, we can then use the policy it has learned to make trading decisions (hopefully it learns well&mldr; ü§û).</p><h2 id=indicators>Indicators</h2><p>The success of this project hinges on the learner&rsquo;s ability to analyze market indicators to make the best trading decision possible. We will discretize three indicators: momentum<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>, Bollinger Bands %B (BBP)<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, and moving average convergence/divergence (MACD)<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> so our learner can assess market conditions and make trading decisions.</p><blockquote><p>Since these are all momentum indicators, we will be employing a momentum-based trading strategy that goes long when momentum is increasing, and short when momentum is decreasing.</p></blockquote><h2 id=strategy-comparisons>Strategy Comparisons</h2><p>To gauge the effectiveness of each strategy, two additional strategies will be used as a comparison for the Q-Learner&rsquo;s results. The first is a benchmark strategy, which consists of buying 1,000 shares of JPM stock on day one and holding this position for an entire 2-year period. The next is a manual strategy, which involves myself hardcoding threshold values given the raw indicator data, and then making trade decisions based off these thresholds.</p><p>Ideally we should expect both the manual strategy and Q-Learner to outperform the benchmark, though we should expect the greatest return from the Q-Learner strategy, as it should learn nuanced indicator interaction that is definitely not obvious to myself!</p><h2 id=results>Results</h2><p>Training the learner for 15 epochs shows exceptional results against the manual strategy and benchmark.</p><div style=text-align:center><img alt src="https://raw.githubusercontent.com/s-lasch/portfolio/refs/heads/master/exampleSite/content/blogs/ai
-trader/strategy_comparison_out_sample.png"></div><p><em>Returns are based on <strong>cumulative returns</strong>, calculated by dividing the return on day 1 by the return on the last day of the 2-year period.</em></p><p>This means the learner has picked up on some market interactions that I&rsquo;ve overlooked.</p><h2 id=how-do-they-trade>How do they trade?</h2><p>I&rsquo;ve also included a plot showing the number of trades generated by my manual strategy versus the Q-Learner.</p><div style=text-align:center><img alt src="https://raw.githubusercontent.com/s-lasch/portfolio/refs/heads/master/exampleSite/content/blogs/ai
-trader/MS_out_sample.png"></div><p>It&rsquo;s interesting to see that my strategy made significantly less trades, though still performed reasonably well against the learner.</p><div style=text-align:center><img alt src="https://raw.githubusercontent.com/s-lasch/portfolio/refs/heads/master/exampleSite/content/blogs/ai
-trader/strategy_learner_trades_out_sample.png"></div><p>This suggests that making small, incremental transactions can be beneficial in this context. Though, these results are <strong>not taking transaction costs into account!</strong> This is significant because making a large number of trades over time diminishes overall returns. We will focus on two: <strong>market impact</strong> and <strong>commission</strong> as our transaction costs. So, we need to modify our reward function to discourage the learner based on the market impact.</p><h2 id=conclusion>Conclusion</h2><p>In this post, we covered some basic momentum indicators to gauge market impact, and how to use them in a Q-Learner strategy. We then compared results to show that the Q-Learner is capable of picking up on nuanced momentum shifts. In the next and final part, we will explore the effects of transaction costs on the Q-Learner strategy.</p><h2 id=references>References</h2><p>If you&rsquo;re interested, here is more information on the indicators used in this project:</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.investopedia.com/terms/m/momentum.asp target=_blank rel=noopener>Momentum - (Investopedia)</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://StockCharts.stockcharts.com/table-of-contents/technical-indicators-and-overlays/technical-indicators/b-indicator%7d%7b%5c%25B target=_blank rel=noopener>%B Indicator - (StockCharts)</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://StockCharts.stockcharts.com/table-of-contents/technical-indicators-and-overlays/technical-indicators/macd-moving-average-convergence-divergence-oscillator target=_blank rel=noopener>MACD - (StockCharts)</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®:</strong>
<a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fslasch-portfolio.github.io%2fposts%2fai-trader%2fpart-2%2f&title=AI-Assisted%20Trader%20%28Part%202%29" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button" href="mailto:?subject=AI-Assisted%20Trader%20%28Part%202%29&body=https%3a%2f%2fslasch-portfolio.github.io%2fposts%2fai-trader%2fpart-2%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/s-lasch/slasch-portfolio.github.io/edit/main/content/posts/ai-trader/part-2/index.md title="‡¶è‡¶á ‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ‡¶ü‡¶ø ‡¶â‡¶®‡ßç‡¶®‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
‡¶è‡¶á ‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ‡¶ü‡¶ø ‡¶â‡¶®‡ßç‡¶®‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/ai-trader/part-1/ title="AI-Assisted Trader - Introduction (Part 1)" class="btn filled-button"><div><i class="fas fa-chevron-circle-left"></i> ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</div><div class=next-prev-text>AI-Assisted Trader - Introduction (Part 1)</div></a></div><div class="col-md-6 next-article"><a href=/posts/ai-trader/part-3/ title="AI-Assisted Trader (Part 3)" class="btn filled-button"><div>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>AI-Assisted Trader (Part 3)</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">‡¶∏‡ßÅ‡¶ö‡¶ø‡¶™‡¶§‡ßç‡¶∞</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#tldr>TLDR</a></li><li><a href=#the-process>The Process</a></li><li><a href=#indicators>Indicators</a></li><li><a href=#strategy-comparisons>Strategy Comparisons</a></li><li><a href=#results>Results</a></li><li><a href=#how-do-they-trade>How do they trade?</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#references>References</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-start"><div class="col-md-4 col-sm-12"><h5>‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶®</h5><ul><li class=nav-item><a class=smooth-scroll href=https://slasch-portfolio.github.io/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://slasch-portfolio.github.io/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://slasch-portfolio.github.io/#experiences>Work Experience</a></li><li class=nav-item><a class=smooth-scroll href=https://slasch-portfolio.github.io/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://slasch-portfolio.github.io/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://slasch-portfolio.github.io/#publications>Publications</a></li><li class=nav-item><a class=smooth-scroll href=https://slasch-portfolio.github.io/#featured-posts>Featured Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®‡¶É</h5><ul><li><a href=mailto:info@steven-lasch.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>info@steven-lasch.com</span></a></li><li><a href=https://github.com/s-lasch target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>s-lasch</span></a></li><li><a href=https://www.linkedin.com/in/steven-l-lasch target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Steven Lasch</span></a></li><li><a href=https://www.researchgate.net/profile/Steven-Lasch target=_blank rel=noopener><span><i class="fab fa-researchgate"></i></span> <span>Steven Lasch</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-start"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu_be7279b2506ad3f1.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">¬© 2020 Copyright.</div><div class="col-md-4 text-end"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>‡¶™‡¶æ‡¶ì‡ßü‡¶æ‡¶∞‡¶° ‡¶¨‡¶æ‡¶á
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.fbb925f912f4010df78cab950f66761ded123027b3aaba43003a454c520135c0.js integrity="sha256-+7kl+RL0AQ33jKuVD2Z2He0SMCezqrpDADpFTFIBNcA=" defer></script></body></html>